{{ define "title" }}Home{{ end }}

{{ define "main" }}
  <div class="w-full" data-page="home">
    <div
      id="heroSection"
      class="w-full flex flex-col md:flex-row md:items-center justify-between bg-slate-800 md:py-12 md:px-6 px-3 py-8 gap-8"
    >
      <!-- Hero Text -->
      <div id="heroText" class="flex-1 min-w-[280px] max-w-xl">
        <h1 class="text-white font-bold text-5xl mb-4">
          The Internet Sketch Comedy Database
        </h1>
        <h2 class="text-white text-lg">
          Discover new sketches, actors, and characters or find sketches from
          creators / shows you know and love!
        </h2>
        <a href="/browse">
          <button
            class="my-7 bg-slate-500 text-white font-bold py-2 px-4 rounded hover:bg-slate-600"
          >
            Browse Videos
          </button>
        </a>
      </div>

      <!-- Hero Image -->
      <!-- <div id="heroThumbnailPreview" class="flex-shrink basis-[680px]">
        <div id="heroThumbnail" class="rounded-md">
          <img
            src="/images/test/video/goodpals_fullpreview.jpg"
            class="w-full object-cover rounded-md"
            alt="Hero Thumbnail"
          />
        </div>
      </div> -->
      <!-- <div class="md:flex-shrink md:basis-[680px] h-fit">
        <div class="relative w-full overflow-hidden">
          <div
            id="carousel-track"
            class="flex transition-transform duration-500 ease-in-out h-full"
          >
            <div class="flex-shrink-0 w-full h-full">
              <img
                src="/images/test/video/goodpals_fullpreview.jpg"
                class="w-full h-full object-cover"
                alt="Slide 1"
              />
            </div>
            <div class="flex-shrink-0 w-full h-full">
              <img
                src="/images/test/video/goodpals_fullpreview.jpg"
                class="w-full h-full object-cover"
                alt="Slide 2"
              />
            </div>
            <div class="flex-shrink-0 w-full h-full">
              <img
                src="/images/test/video/goodpals_fullpreview.jpg"
                class="w-full object-cover"
                alt="Slide 3"
              />
            </div>
          </div>

          <button
            id="prev"
            class="absolute top-1/2 left-4 -translate-y-1/2 bg-black/50 hover:bg-black/80 text-white p-2 rounded-full"
          >
            ←
          </button>
          <button
            id="next"
            class="absolute top-1/2 right-4 -translate-y-1/2 bg-black/50 hover:bg-black/80 text-white p-2 rounded-full"
          >
            →
          </button>
        </div>
      </div>
    </div> -->
      <div class="md:flex-shrink md:basis-[680px] h-fit">
        <div
          class="relative overflow-hidden w-full max-w-4xl mx-auto"
          id="carousel"
        >
          <div
            id="carousel-track"
            class="flex transition-transform duration-500 ease-in-out"
          >
            <div class="flex-shrink-0 w-full">
              <img
                src="/images/test/video/goodpals_fullpreview.jpg"
                class="w-full h-auto"
                alt="Clone Last"
              />
            </div>
            <div class="flex-shrink-0 w-full">
              <img
                src="/images/test/video/goodpals_fullpreview.jpg"
                class="w-full h-auto"
                alt="1"
              />
            </div>
            <div class="flex-shrink-0 w-full">
              <img
                src="/images/test/video/goodpals_fullpreview.jpg"
                class="w-full h-auto"
                alt="2"
              />
            </div>
            <div class="flex-shrink-0 w-full">
              <img
                src="/images/test/video/goodpals_fullpreview.jpg"
                class="w-full h-auto"
                alt="3"
              />
            </div>
            <div class="flex-shrink-0 w-full">
              <img
                src="/images/test/video/goodpals_fullpreview.jpg"
                class="w-full h-auto"
                alt="Clone First"
              />
            </div>
          </div>
          <!-- Navigation Buttons -->
          <button
            id="prevBtn"
            class="absolute top-1/2 left-4 -translate-y-1/2 bg-white bg-opacity-70 rounded-full p-2 shadow z-10"
          >
            ⬅
          </button>
          <button
            id="nextBtn"
            class="absolute top-1/2 right-4 -translate-y-1/2 bg-white bg-opacity-70 rounded-full p-2 shadow z-10"
          >
            ➡
          </button>
        </div>
      </div>
    </div>
    <div class="px-2">
      <h2 class="font-bold text-xl my-3">
        <a href="/catalog/sketches?sort=oldest" class="hover:underline"
          >Latest Sketches</a
        >
      </h2>
      {{ template "video-carousel" (dict "ImageBaseUrl" $.ImageBaseUrl "Videos" .Videos) }}
    </div>
  </div>
  <script>
    const track = document.getElementById("carousel-track");
    const slides = track.children;
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const carousel = document.getElementById("carousel");

    let index = 1;
    let isDragging = false;
    let startPos = 0;
    let currentTranslate = 0;
    let prevTranslate = 0;
    let animationID;
    let autoplayInterval;
    let slideWidth = slides[0].clientWidth;
    const intervalLength = 6000;

    window.addEventListener("resize", () => {
      slideWidth = slides[0].clientWidth;
      track.style.transition = "none"; // remove transition during resize
      setPosition();
      prevTranslate = -slideWidth * index;
      currentTranslate = prevTranslate;
    });

    function setPosition() {
      track.style.transform = `translateX(${-slideWidth * index}px)`;
    }

    function nextSlide() {
      if (index >= slides.length - 1) return;
      index++;
      track.style.transition = "transform 0.5s ease-in-out";
      setPosition();
    }

    function prevSlide() {
      if (index <= 0) return;
      index--;
      track.style.transition = "transform 0.5s ease-in-out";
      setPosition();
    }

    function startAutoplay() {
      autoplayInterval = setInterval(() => {
        nextSlide();
      }, intervalLength);
    }

    function stopAutoplay() {
      clearInterval(autoplayInterval);
    }

    nextBtn.addEventListener("click", () => {
      stopAutoplay();
      nextSlide();
      startAutoplay();
    });

    prevBtn.addEventListener("click", () => {
      stopAutoplay();
      prevSlide();
      startAutoplay();
    });

    track.addEventListener("transitionend", () => {
      if (slides[index].alt === "Clone First") {
        track.style.transition = "none";
        index = 1;
        setPosition();
      }
      if (slides[index].alt === "Clone Last") {
        track.style.transition = "none";
        index = slides.length - 2;
        setPosition();
      }
    });

    // Initialize
    track.style.transform = `translateX(${-slideWidth * index}px)`;
    startAutoplay();
  </script>
  <!-- <script>
    const track = document.getElementById("carousel-track");
    const slides = track.children;
    const totalSlides = slides.length;
    let currentSlide = 0;

    function updateCarousel() {
      const offset = -(currentSlide * 100);
      track.style.transform = `translateX(${offset}%)`;
    }

    document.getElementById("prev").addEventListener("click", () => {
      currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
      updateCarousel();
    });

    document.getElementById("next").addEventListener("click", () => {
      currentSlide = (currentSlide + 1) % totalSlides;
      updateCarousel();
    });
  </script> -->
{{ end }}
